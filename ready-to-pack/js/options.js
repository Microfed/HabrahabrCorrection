getTreeDiv=function(){return $("#errorTree")};function save_options(){var a=document.getElementById("isAdvtAttachToMessage").checked;localStorage.isAdvtAttachToMessage=a;var b=getTreeDiv().dynatree("getTree").toDict();localStorage.errorList=JSON.stringify(b.children);printStatusMessage("Сохранено")}function printStatusMessage(a){$("#status").append(a);$("#status").show();setTimeout(function(){$("#status").effect("fade",500,function(){$("#status").empty()})},2000)}function setErrorListFromFile(){$.getJSON(chrome.extension.getURL("/errorList.json"),function(a){localStorage.errorList=JSON.stringify(a);setTreeInfo();printStatusMessage("Список ошибок загружен")}).error(function(){printStatusMessage("Проблема при загрузке файла. Список ошибок не обновлен.")})}setButtonUI=function(){$("button","#activeTreeElement").button()};deleteActiveElement=function(){getTreeDiv().dynatree("getActiveNode").remove();$("#activeTreeElement").show()};acceptChangeActiveElement=function(){var b=getTreeDiv().dynatree("getActiveNode");if(!b){return}var d=$("#activeTreeElement #title").val();var c=$("#activeTreeElement #messageText").val();var a=$("#activeTreeElement #isFolder").val();b.fromDict({title:d,messageText:c,isFolder:a})};addNewElement=function(){var a;var b=getTreeDiv().dynatree("getRoot");var f=getTreeDiv().dynatree("getActiveNode");if(f!==null){if(f.data.isFolder){a=f}else{a=f.getParent()}}else{a=b;f=b}var e=$("#activeTreeElement #title").val();var d=$("#activeTreeElement #messageText").val();var c=false;if(a===b&&!(f.data.isFolder)){c=($("#activeTreeElement #isFolder:checked").val()!==undefined)}a.addChild({title:e,messageText:d,isFolder:c})};function addButtonsToManageTree(){setButtonUI();$("#delete","#activeTreeElement").click(deleteActiveElement);$("#accept","#activeTreeElement").click(acceptChangeActiveElement);$("#add","#activeTreeElement").click(addNewElement)}function setTreeInfo(){var a=getTreeDiv();if(a.text()!==""){a.dynatree("getTree").reload()}else{a.dynatree({onActivate:function(b){printNodeInfo(b)},onDeactivate:function(b){clearNodeInfo()},children:JSON.parse(localStorage.errorList)});addButtonsToManageTree()}}function restore_options(){var b=localStorage.isAdvtAttachToMessage;var a=false;if(b=="true"){a=true}document.getElementById("isAdvtAttachToMessage").checked=a;if(localStorage.errorList===undefined){setErrorListFromFile()}setTreeInfo()}function printNodeInfo(a){$("#activeTreeElement #title").val(a.data.title);$("#activeTreeElement #messageText").val(a.data.messageText);if(a.data.isFolder){$("#activeTreeElement #isFolder").attr("checked","checked")}$("#activeTreeElement").show()}function clearNodeInfo(){$("#activeTreeElement #title").empty();$("#activeTreeElement #messageText").empty();$("#activeTreeElement #isFolder").removeAttr("checked");$("#activeTreeElement").hide()};