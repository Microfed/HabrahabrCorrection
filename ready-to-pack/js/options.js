var getTreeDiv=function(){return $("#errorTree")};function printNodeInfo(a){$("#activeTreeElement #title").val(a.data.title);$("#activeTreeElement #messageText").val(a.data.messageText);if(a.data.isFolder){$("#activeTreeElement #isFolder").attr("checked","checked")}$("#activeTreeElement").show()}function clearNodeInfo(){$("#activeTreeElement #title").empty();$("#activeTreeElement #messageText").empty();$("#activeTreeElement #isFolder").removeAttr("checked");$("#activeTreeElement").hide()}function printStatusMessage(a){$("#status").append(a);$("#status").show();setTimeout(function(){$("#status").effect("fade",500,function(){$("#status").empty()})},2000)}function save_options(){localStorage.isAdvtAttachToMessage=document.getElementById("isAdvtAttachToMessage").checked;var a=getTreeDiv().dynatree("getTree").toDict();localStorage.errorList=JSON.stringify(a.children);printStatusMessage("Сохранено")}var setButtonUI=function(){$("button","#activeTreeElement").button()};var deleteActiveElement=function(){getTreeDiv().dynatree("getActiveNode").remove();$("#activeTreeElement").show()};var acceptChangeActiveElement=function(){var b=getTreeDiv().dynatree("getActiveNode"),d=$("#activeTreeElement #title").val(),c=$("#activeTreeElement #messageText").val(),a=$("input#isFolder").attr("checked")?true:false;console.log(a);if(!b){return}b.fromDict({title:d,messageText:c,isFolder:a})};var addNewElement=function(){var a,b=getTreeDiv().dynatree("getRoot"),f=getTreeDiv().dynatree("getActiveNode"),e=$("#activeTreeElement #title").val(),d=$("#activeTreeElement #messageText").val(),c=false;if(f!==null){if(f.data.isFolder){a=f}else{a=f.getParent()}}else{a=b;f=b}if(a===b&&!(f.data.isFolder)){c=($("#activeTreeElement #isFolder:checked").val()!==undefined)}a.addChild({title:e,messageText:d,isFolder:c})};function addButtonsToManageTree(){setButtonUI();$("#delete","#activeTreeElement").click(deleteActiveElement);$("#accept","#activeTreeElement").click(acceptChangeActiveElement);$("#add","#activeTreeElement").click(addNewElement)}function setTreeInfo(){var a=getTreeDiv();if(a.text()!==""){a.dynatree("getTree").reload()}else{a.dynatree({onActivate:function(b){printNodeInfo(b)},onDeactivate:function(){clearNodeInfo()},children:JSON.parse(localStorage.errorList)});addButtonsToManageTree()}}function setErrorListFromFile(){$.getJSON(chrome.extension.getURL("/errorList.json"),function(a){localStorage.errorList=JSON.stringify(a);setTreeInfo();printStatusMessage("Список ошибок загружен")}).error(function(){printStatusMessage("Проблема при загрузке файла. Список ошибок не обновлен.")})}function restore_options(){var b=localStorage.isAdvtAttachToMessage,a=false;if(b==="true"){a=true}document.getElementById("isAdvtAttachToMessage").checked=a;if(localStorage.errorList===undefined){setErrorListFromFile()}setTreeInfo()};